package com.javaman.madax.shorts.service;

import java.io.File;
import java.io.IOException;
import java.io.OutputStream;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.PropertySource;
import org.springframework.stereotype.Service;
import org.springframework.web.multipart.MultipartFile;

@Service
@PropertySource("classpath:/config.properties")
public class BasicService {
	
	@Value("${my.video.location}")
	private String folderPath;
	
//	public void saveFile(MultipartFile shortsVideo) {
//
//		if(!shortsVideo.isEmpty()) {
//			Path filePath = Paths.get(folderPath, shortsVideo.getOriginalFilename());
//			
//			try(OutputStream os = Files.newOutputStream(filePath)) {
//				os.write(shortsVideo.getBytes());
//			} catch (IOException e) {
//				throw new RuntimeException(e);
//			}
//		}
//		
//	}

	public boolean saveFile(MultipartFile shortsVideo, int chunkNumber, int totalChunks) throws IOException {

		File dir = new File(folderPath);
        if (!dir.exists()) {
            dir.mkdirs();
        }
		
        String filename = shortsVideo.getOriginalFilename() + ".part" + chunkNumber;
        Path path = Paths.get(folderPath,filename);
        Files.write(path, shortsVideo.getBytes());
        
        
		return false;
	}

}
